datasource postgres {
  provider = "postgres"
  url      = env("POSTGRESQL_URL")
  default  = true
}

generator client {
  provider = "prisma-client-js"
}

model Block {
  id                Int           @default(autoincrement()) @id
  height            Int           @unique
  transactionsCount Int
  transactions      Transaction[]
  preHash           String
  timestamp         DateTime
  orderRoot         String
  stateRoot         String
  proposer          String
  proof             Proof
  validatorVersion  String
  validators        Validator[]
}

model Validator {
  id            Int     @default(autoincrement()) @id
  address       String  @unique
  proposeWeight Int
  voteWeight    Int
  blocks        Block[]
}

model Transaction {
  id          Int      @default(autoincrement()) @id
  txHash      String   @unique
  receipt     Receipt?
  block       Block
  serviceName String
  method      String
  payload     String
  cyclesPrice String
  cyclesLimit String
  nonce       String
  pubkey      String
  signature   String
  chainId     String
  timeout     String
  account     Account
}

model Receipt {
  id          Int             @default(autoincrement()) @id
  block       Block
  transaction Transaction
  cyclesUsed  String
  events      Event[]
  response    ReceiptResponse
}

model ReceiptResponse {
  id      Int     @default(autoincrement()) @id
  receipt Receipt
  ret     String
  isError Boolean
}

model Event {
  id      Int     @default(autoincrement()) @id
  receipt Receipt
  service String
  data    String
}

model Proof {
  id        Int    @default(autoincrement()) @id
  height    Int
  round     Int
  blockHash String
  signature String
  bitmap    String
}

model Account {
  id           Int           @default(autoincrement()) @id
  address      String        @unique
  transactions Transaction[]
}